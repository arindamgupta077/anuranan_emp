# PWA Setup - Quick Reference

## âœ… What's Been Fixed

1. **PWA Configuration** - Properly configured in `next.config.js`
2. **Service Worker** - Automatically generated by next-pwa
3. **Manifest** - Created with app metadata in `public/manifest.json`
4. **Offline Page** - Created at `pages/offline.tsx`
5. **Icons** - SVG icons created (PNG needed for full mobile support)
6. **Dev Warnings** - PWA disabled in dev mode to reduce noise

## ğŸš€ Quick Start

### For Development (No PWA Warnings)
```bash
npm run dev
```
PWA is disabled, no warnings.

### For Testing PWA Features
```bash
npm run dev:pwa
```
PWA is enabled, expect service worker regeneration warnings.

Or toggle manually:
```bash
npm run pwa:enable   # Enable PWA in dev
npm run dev          # Start server
npm run pwa:disable  # Disable PWA (default)
```

## ğŸ“± Install App on Mobile

### Step 1: Generate PNG Icons (REQUIRED for iOS)

**Option A - Use Browser Tool (Easiest)**
1. Start dev server: `npm run dev`
2. Visit: http://localhost:3000/icon-generator.html
3. Download all 3 PNG icons
4. Move files to `frontend/public/icons/`:
   - `icon-192x192.png`
   - `icon-512x512.png`
   - `apple-touch-icon.png`

**Option B - Use Online Tool**
1. Visit: https://realfavicongenerator.net/
2. Upload a logo or use text "A" with color #14b8a6
3. Download and extract
4. Copy PNG files to `frontend/public/icons/`

### Step 2: Update Manifest (After Creating PNGs)

Edit `public/manifest.json`:
```json
"icons": [
  {
    "src": "/icons/icon-192x192.png",
    "sizes": "192x192",
    "type": "image/png",
    "purpose": "any maskable"
  },
  {
    "src": "/icons/icon-512x512.png",
    "sizes": "512x512",
    "type": "image/png",
    "purpose": "any maskable"
  }
]
```

Edit `pages/_document.tsx`:
```tsx
<link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
```

### Step 3: Test on Mobile

**Android (Chrome/Edge)**
1. Find your PC IP: `ipconfig` (look for IPv4, e.g., 192.168.0.183)
2. On phone browser: `http://YOUR_IP:3000`
3. Tap menu (â‹®) â†’ "Install app"

**iOS (Safari)**
1. Same URL as Android: `http://YOUR_IP:3000`
2. **Must use Safari** (not Chrome)
3. Tap Share â†’ "Add to Home Screen"
4. **Note**: PNG icons are required for iOS

## âš ï¸ Understanding the Warnings

### "GenerateSW has been called multiple times"
- **Cause**: next-pwa regenerates service worker on every file change
- **Impact**: None - just noise in development
- **Solution**: PWA is disabled in dev by default
- **When to enable**: Only when testing PWA features

### "Fast Refresh had to perform a full reload"
- **Cause**: Service worker changes require full page reload
- **Impact**: Slower development experience
- **Solution**: Use `npm run dev` (PWA disabled) for normal development

### "Cross origin request detected"
- **Cause**: Accessing from mobile device on local network
- **Impact**: None - warning only
- **Fixed**: Added headers configuration in next.config.js

## ğŸ“‹ Commands Reference

```bash
# Development
npm run dev              # Normal dev mode (no PWA, no warnings)
npm run dev:pwa          # Dev mode with PWA enabled

# PWA Toggle
npm run pwa:enable       # Enable PWA in development
npm run pwa:disable      # Disable PWA (default)

# Icons
npm run icons            # Generate SVG icons
# Then visit /icon-generator.html to create PNGs

# Production
npm run build            # Build for production (PWA enabled)
npm start                # Run production build

# Utility
npm run lint             # Run ESLint
npm run type-check       # TypeScript type checking
```

## ğŸ› Troubleshooting

### Can't install on mobile?
- âœ… **Create PNG icons** (not SVG) - see Step 1 above
- âœ… Enable PWA: `npm run pwa:enable` then restart server
- âœ… Clear browser cache on mobile
- âœ… On iOS: **Must use Safari browser**
- âœ… Check manifest: http://YOUR_IP:3000/manifest.json
- âœ… Check icons exist: http://YOUR_IP:3000/icons/icon-192x192.png

### Too many warnings in dev?
```bash
npm run pwa:disable
# Restart server
npm run dev
```

### Service worker not updating?
1. DevTools â†’ Application â†’ Service Workers
2. Click "Unregister"
3. Hard refresh (Ctrl+Shift+R)

### Mobile can't reach server?
```bash
# Check your IP
ipconfig | findstr IPv4

# Make sure phone is on same WiFi network
# Use IP address, not localhost
# Example: http://192.168.0.183:3000
```

## ğŸ¯ Production Checklist

Before deploying:
- [ ] Create PNG icons (all sizes)
- [ ] Update manifest.json to use .png
- [ ] Update _document.tsx for PNG apple-touch-icon
- [ ] Test on real Android device
- [ ] Test on real iOS device (Safari)
- [ ] Ensure HTTPS is configured
- [ ] Run Lighthouse PWA audit
- [ ] Verify offline functionality works

## ğŸ“ File Structure

```
frontend/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ manifest.json          # PWA manifest
â”‚   â”œâ”€â”€ icon-generator.html    # Tool to create PNGs
â”‚   â”œâ”€â”€ sw.js                  # Auto-generated service worker
â”‚   â””â”€â”€ icons/
â”‚       â”œâ”€â”€ icon-192x192.svg   # âœ… Created (need PNG)
â”‚       â”œâ”€â”€ icon-512x512.svg   # âœ… Created (need PNG)
â”‚       â””â”€â”€ apple-touch-icon.svg # âœ… Created (need PNG)
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ _app.tsx               # Viewport meta tag
â”‚   â”œâ”€â”€ _document.tsx          # PWA meta tags
â”‚   â””â”€â”€ offline.tsx            # Offline fallback page
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ create-icons.js        # Generate SVG icons
â”‚   â””â”€â”€ pwa-toggle.js          # Enable/disable PWA
â””â”€â”€ next.config.js             # PWA configuration

```

## ğŸ”— Useful Links

- Icon Generator (Local): http://localhost:3000/icon-generator.html
- Real Favicon Generator: https://realfavicongenerator.net/
- Favicon.io: https://favicon.io/favicon-generator/
- PWA Builder: https://www.pwabuilder.com/
- Next PWA Docs: https://github.com/shadowwalker/next-pwa

## ğŸ“Š Current Status

| Feature | Status | Notes |
|---------|--------|-------|
| Service Worker | âœ… | Auto-generated |
| Manifest | âœ… | Configured |
| Offline Page | âœ… | Created |
| SVG Icons | âœ… | Created |
| PNG Icons | âš ï¸ | **Need to create** |
| Dev Mode | âœ… | PWA disabled (no warnings) |
| Prod Mode | âœ… | PWA enabled |

## ğŸ‰ Next Steps

1. **Create PNG icons**: Visit http://localhost:3000/icon-generator.html
2. **Update manifest**: Change .svg to .png
3. **Test on mobile**: Use your network IP address
4. **Deploy**: PWA will automatically work in production

**Need Help?** Check `INSTALL_PWA.md` for detailed instructions.
